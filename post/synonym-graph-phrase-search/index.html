<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.5.0"><meta name=author content="Dainius Jocas"><meta name=description content="An idea on how to search for short string with a long query string"><link rel=alternate hreflang=en-us href=https://www.jocas.lt/blog/post/synonym-graph-phrase-search/><meta name=theme-color content="#2962ff"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin=anonymous><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap"><link rel=stylesheet href=/blog/css/academic.css><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','UA-122337142-2');</script><link rel=manifest href=/blog/index.webmanifest><link rel=icon type=image/png href=/blog/img/icon-32.png><link rel=apple-touch-icon type=image/png href=/blog/img/icon-192.png><link rel=canonical href=https://www.jocas.lt/blog/post/synonym-graph-phrase-search/><meta property="twitter:card" content="summary_large_image"><meta property="og:site_name" content="Dainius Jocas"><meta property="og:url" content="https://www.jocas.lt/blog/post/synonym-graph-phrase-search/"><meta property="og:title" content="Phrase Search with Synonym Graph Token Filter in Elasticsearch | Dainius Jocas"><meta property="og:description" content="An idea on how to search for short string with a long query string"><meta property="og:image" content="https://www.jocas.lt/blog/post/synonym-graph-phrase-search/featured.jpeg"><meta property="twitter:image" content="https://www.jocas.lt/blog/post/synonym-graph-phrase-search/featured.jpeg"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2019-12-22T00:00:00+00:00"><meta property="article:modified_time" content="2019-12-22T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.jocas.lt/blog/post/synonym-graph-phrase-search/"},"headline":"Phrase Search with Synonym Graph Token Filter in Elasticsearch","image":["https://www.jocas.lt/blog/post/synonym-graph-phrase-search/featured.jpeg"],"datePublished":"2019-12-22T00:00:00Z","dateModified":"2019-12-22T00:00:00Z","author":{"@type":"Person","name":"Dainius Jocas"},"publisher":{"@type":"Organization","name":"Dainius Jocas","logo":{"@type":"ImageObject","url":"https://www.jocas.lt/blog/img/icon-512.png"}},"description":"An idea on how to search for short string with a long query string"}</script><title>Phrase Search with Synonym Graph Token Filter in Elasticsearch | Dainius Jocas</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id=navbar-main><div class=container><a class=navbar-brand href=https://www.jocas.lt/>Dainius Jocas</a>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="collapse navbar-collapse" id=navbar><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=/blog/#posts><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/blog/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/blog/#talks><span>Talks</span></a></li></ul><ul class="navbar-nav ml-auto"><li class=nav-item><a class="nav-link js-search" href=#><i class="fas fa-search" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link js-dark-toggle" href=#><i class="fas fa-moon" aria-hidden=true></i></a></li></ul></div></div></nav><article class=article><div class="article-container pt-3"><h1>Phrase Search with Synonym Graph Token Filter in Elasticsearch</h1><div class=article-metadata><div><span><a href=/blog/authors/dainius-jocas/>Dainius Jocas</a></span></div><span class=article-date>Dec 22, 2019</span>
<span class=middot-divider></span><span class=article-reading-time>7 min read</span>
<span class=middot-divider></span><span class=article-categories><i class="fas fa-folder mr-1"></i><a href=/blog/categories/elasticsearch/>elasticsearch</a></span></div><div class="btn-links mb-3"></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:720px;max-height:480px><div style=position:relative><img src=/blog/post/synonym-graph-phrase-search/featured_hu7ad1df910346b8123628e9d114769412_119431_720x0_resize_q90_lanczos.jpeg alt class=featured-image>
<span class=article-header-caption><a href=https://www.infoworld.com/article/3442739/review-elasticsearch-boosts-search-with-sql-optimizations.html>Photo by www.infoworld.com</a></span></div></div><div class=article-container><div class=article-style><p>I've <a href=https://www.jocas.lt/blog/post/es-percolator-phrase-highlight/>written</a> that if you google for <code>How can you match a long query text to a short text field?</code> you're advised to use Elasticsearch Percolator. Today I'll show an alternative way of solving the same problem with Elasticsearch.</p><p>The main idea is to use <a href=https://www.elastic.co/guide/en/elasticsearch/reference/master/analysis-synonym-graph-tokenfilter.html>Synonym Graph Token Filter</a> with some data preparation.</p><h2 id=problem-statement>Problem Statement</h2><p>Say that we learned how extract some entity from free form text with techniques such as NER, dictionary annotations, or some fancy Machine Learning. And when this entity is mentioned in the search query we want to boost documents that mention this entity. Also, say you've ruled out using Elasticsearch Percolator because it increases network latency because it requires additional call to Elasticsearch.</p><p>For further discussion our unstructured text is going to be <code>This description is about a Very Important Thing and something else.</code> and the extracted entity <code>Very Important Thing</code>. Our test document looks like :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;This description is about a Very Important Thing and something else.&#34;</span>,
  <span style=color:#f92672>&#34;entity&#34;</span>: <span style=color:#e6db74>&#34;Very Important Thing&#34;</span>
}
</code></pre></div><p>Search queries:</p><ul><li><code>prefix very important thing suffix</code></li><li><code>prefix very important another thing suffix</code></li><li><code>prefix thing suffix</code></li></ul><p>All examples are tested on Elasticsearch 7.5.1.</p><h3 id=naive-setup>Naive Setup</h3><p>Let's create an index for our documents:</p><pre><code>PUT /test_index-2
{
  &quot;mappings&quot;: {
    &quot;properties&quot;: {
      &quot;description&quot;: {
        &quot;type&quot;: &quot;text&quot;
      },
      &quot;entity&quot;: {
        &quot;type&quot;:  &quot;text&quot;
      }
    }
  }
}
</code></pre><p>Entity field is of type <code>text</code> because we want it to be searchable. <code>keyword</code> type won't work because it does only exact matches and out query most likely will be longer than our entity string.</p><p>Index our document:</p><pre><code>PUT test_index-2/_doc/1
{
  &quot;description&quot;: &quot;This description is about a Very Important Thing and something else.&quot;,
  &quot;entity&quot;: &quot;Very Important Thing&quot;
}
</code></pre><p>Search the index with the query that mentions our <code>very important thing</code>:</p><pre><code>GET test_index-2/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;entity&quot;: {
        &quot;query&quot;: &quot;prefix very important thing suffix&quot;,
        &quot;boost&quot;: 2
      }
    }
  }
}
</code></pre><p>This yields:</p><pre><code>{
  &quot;took&quot; : 1,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 1.7260926,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;test_index-2&quot;,
        &quot;_type&quot; : &quot;_doc&quot;,
        &quot;_id&quot; : &quot;1&quot;,
        &quot;_score&quot; : 1.7260926,
        &quot;_source&quot; : {
          &quot;description&quot; : &quot;This description is about a Very Important Thing and something else.&quot;,
          &quot;entity&quot; : &quot;Very Important Thing&quot;
        }
      }
    ]
  }
}
</code></pre><p>Cool, we found what we we looking for.</p><p>Let's try another query, this time with a mention of <code>very important another thing</code>:</p><pre><code>GET test_index-2/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;entity&quot;: {
        &quot;query&quot;: &quot;prefix very important another thing suffix&quot;,
        &quot;boost&quot;: 2
      }
    }
  }
}
</code></pre><p>This yields:</p><pre><code>{
  &quot;took&quot; : 1,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 1.7260926,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;test_index-2&quot;,
        &quot;_type&quot; : &quot;_doc&quot;,
        &quot;_id&quot; : &quot;1&quot;,
        &quot;_score&quot; : 1.7260926,
        &quot;_source&quot; : {
          &quot;description&quot; : &quot;This description is about a Very Important Thing and something else.&quot;,
          &quot;entity&quot; : &quot;Very Important Thing&quot;
        }
      }
    ]
  }
}
</code></pre><p>Oh, the results are the same as with the previous query despite the fact that we mention <code>Another Thing</code> here. But it still might be OK because we matched all the terms of the entity.</p><p>Let's try another query:</p><pre><code>GET test_index-2/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;entity&quot;: {
        &quot;query&quot;: &quot;prefix thing suffix&quot;,
        &quot;boost&quot;: 2
      }
    }
  }
}
</code></pre><p>This yields:</p><pre><code>{
  &quot;took&quot; : 1,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 0.5753642,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;test_index-2&quot;,
        &quot;_type&quot; : &quot;_doc&quot;,
        &quot;_id&quot; : &quot;1&quot;,
        &quot;_score&quot; : 0.5753642,
        &quot;_source&quot; : {
          &quot;description&quot; : &quot;This description is about a Very Important Thing and something else.&quot;,
          &quot;entity&quot; : &quot;Very Important Thing&quot;
        }
      }
    ]
  }
}
</code></pre><p>Oh no, we still matched our <code>Very Important Thing</code> while only <code>thing</code> term is present in the query. But at least this time the score is lower than with previous twoqueries, 0.5753642 vs. 1.7260926. Here we clearly see the problem: we are matching short strings with long strings and partial matches raises problems.</p><h2 id=proposed-solution>Proposed Solution</h2><p>Let's leverage Synonym Graph Token Filter to solve our problem.</p><pre><code>PUT /test_index-1
{
  &quot;mappings&quot;: {
    &quot;properties&quot;: {
      &quot;descrition&quot;: {
        &quot;type&quot;:  &quot;text&quot;
      },
      &quot;entity&quot;: {
        &quot;type&quot;:  &quot;text&quot;,
        &quot;analyzer&quot;: &quot;lowercase_keyword_analyzer&quot;,
        &quot;search_analyzer&quot;: &quot;synonym_graph_analyzer&quot;
      }
    }
  },
  &quot;settings&quot;: {
    &quot;index&quot;: {
      &quot;analysis&quot;: {
        &quot;analyzer&quot;: {
          &quot;synonym_graph_analyzer&quot;: {
            &quot;tokenizer&quot;: &quot;standard&quot;,
            &quot;filter&quot;: [
              &quot;lowercase&quot;,
              &quot;my_synonym_graph&quot;
            ]
          },
          &quot;lowercase_keyword_analyzer&quot;: {
            &quot;tokenizer&quot;: &quot;keyword&quot;,
            &quot;filter&quot;: [
              &quot;lowercase&quot;
            ],
            &quot;char_filter&quot;: [
              &quot;spaces_to_undescores_filter&quot;
            ]
          }
        },
        &quot;char_filter&quot;: {
          &quot;spaces_to_undescores_filter&quot;: {
            &quot;type&quot;: &quot;mapping&quot;,
            &quot;mappings&quot;: [
              &quot; \\u0020 =&gt; _&quot;
            ]
          }
        },
        &quot;filter&quot;: {
          &quot;my_synonym_graph&quot;: {
            &quot;type&quot;: &quot;synonym_graph&quot;,
            &quot;lenient&quot;: true,
            &quot;synonyms&quot;: [
              &quot;very important thing =&gt; very_important_thing&quot;
            ]
          }
        }
      }
    }
  }
}
</code></pre><p>Let's decompose this large index configuration piece by piece:</p><ol><li>The <code>entity</code> attribute now has separate analyzers for both index and search phases.</li><li>The <code>lowercase_keyword_analyzer</code> uses keyword tokenizer which means that tokenization will result in the sequence of token of size 1, then it normalizes tokens by lowercasing them and finally <code>spaces_to_undescores_filter</code>, replaces spaces to underscores. E.g. a string <code>"Very Important Thing"</code> is transformed into list of tokens <code>["very_important_thing"]</code>. Or use out friend <code>_analyze</code> API:</li></ol><pre><code>POST test_index-1/_analyze
{
  &quot;text&quot;: [&quot;Very Important Thing&quot;],
  &quot;analyzer&quot;: &quot;lowercase_keyword_analyzer&quot;
}
</code></pre><p>This yields:</p><pre><code>{
  &quot;tokens&quot; : [
    {
      &quot;token&quot; : &quot;very_important_thing&quot;,
      &quot;start_offset&quot; : 0,
      &quot;end_offset&quot; : 20,
      &quot;type&quot; : &quot;word&quot;,
      &quot;position&quot; : 0
    }
  ]
}
</code></pre><ol start=3><li>The <code>synonym_graph_analyzer</code> use standard tokenizer, which is followed by the <code>lowercase</code> filter, and then the <code>my_synonym_graph</code> token filter is applied. We've set up one synonym <code>"very important thing => very_important_thing"</code>. E.g.</li></ol><pre><code>POST test_index-1/_analyze
{
  &quot;text&quot;: [&quot;prefix very important thing suffix&quot;],
  &quot;analyzer&quot;: &quot;synonym_graph_analyzer&quot;
}
</code></pre><p>This yields:</p><pre><code>{
  &quot;tokens&quot; : [
    {
      &quot;token&quot; : &quot;prefix&quot;,
      &quot;start_offset&quot; : 0,
      &quot;end_offset&quot; : 6,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 0
    },
    {
      &quot;token&quot; : &quot;very_important_thing&quot;,
      &quot;start_offset&quot; : 7,
      &quot;end_offset&quot; : 27,
      &quot;type&quot; : &quot;SYNONYM&quot;,
      &quot;position&quot; : 1
    },
    {
      &quot;token&quot; : &quot;suffix&quot;,
      &quot;start_offset&quot; : 28,
      &quot;end_offset&quot; : 34,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 2
    }
  ]
}
</code></pre><p>After analysis we have 3 tokens <code>["prefix", "very_important_thing", "suffix"]</code>. Notice <code>"very_important_thing"</code> token: this is equal to the right-hand-side from our synonym definitions. Now let's run queries from the previous section:</p><pre><code>GET test_index-1/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;entity&quot;: {
        &quot;query&quot;: &quot;prefix very important thing suffix&quot;,
        &quot;boost&quot;: 2
      }
    }
  }
}
</code></pre><p>This yields:</p><pre><code>{
  &quot;took&quot; : 1,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 0.5753642,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;test_index-1&quot;,
        &quot;_type&quot; : &quot;_doc&quot;,
        &quot;_id&quot; : &quot;1&quot;,
        &quot;_score&quot; : 0.5753642,
        &quot;_source&quot; : {
          &quot;description&quot; : &quot;This description is about a Very Important Thing and something else.&quot;,
          &quot;entity&quot; : &quot;Very Important Thing&quot;
        }
      }
    ]
  }
}
</code></pre><p>As expected: exact match -> hit.</p><p>Another query:</p><pre><code>GET test_index-1/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;entity&quot;: {
        &quot;query&quot;: &quot;prefix very important another thing suffix&quot;,
        &quot;boost&quot;: 2
      }
    }
  }
}
</code></pre><p>This yields:</p><pre><code>{
  &quot;took&quot; : 0,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 0,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : null,
    &quot;hits&quot; : [ ]
  }
}
</code></pre><p>No hits! Good! The document is not going to be boosted despite the fact that all tokens match.</p><p>And the last one:</p><pre><code>GET test_index-1/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;entity&quot;: {
        &quot;query&quot;: &quot;prefix thing suffix&quot;,
        &quot;boost&quot;: 2
      }
    }
  }
}
</code></pre><p>This yields:</p><pre><code>{
  &quot;took&quot; : 1,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 0,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : null,
    &quot;hits&quot; : [ ]
  }
}
</code></pre><p>No hits! Good. This means that also substring doesn't match.</p><h2 id=discussion>Discussion</h2><p>Synonym Graph Token Filter can &ldquo;replace&rdquo; a sequence of tokens (e.g. a phrase) with another sequence of tokens. In this particular example: many tokens were replaced with one token.</p><ol><li>One field can have only one analyzer pair for index and search phases. If we want another analysis pipeline for the <code>entity</code> attribute we have to create another field with the analyzers specified, e.g. stemmed phrase with lower boost.</li><li>The synonym list must be prepared before the index creation.</li><li>Management of the synonym list might complicate index management, e.g. you use templates for your index management.</li><li>The overal solution in general might look a bit too complicated.</li></ol></div><div class=article-tags><a class="badge badge-light" href=/blog/tags/elasticsearch/>elasticsearch</a></div><div class=share-box aria-hidden=true><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https://www.jocas.lt/blog/post/synonym-graph-phrase-search/&text=Phrase%20Search%20with%20Synonym%20Graph%20Token%20Filter%20in%20Elasticsearch" target=_blank rel=noopener class=share-btn-twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https://www.jocas.lt/blog/post/synonym-graph-phrase-search/&t=Phrase%20Search%20with%20Synonym%20Graph%20Token%20Filter%20in%20Elasticsearch" target=_blank rel=noopener class=share-btn-facebook><i class="fab fa-facebook-f"></i></a></li><li><a href="mailto:?subject=Phrase%20Search%20with%20Synonym%20Graph%20Token%20Filter%20in%20Elasticsearch&body=https://www.jocas.lt/blog/post/synonym-graph-phrase-search/" target=_blank rel=noopener class=share-btn-email><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https://www.jocas.lt/blog/post/synonym-graph-phrase-search/&title=Phrase%20Search%20with%20Synonym%20Graph%20Token%20Filter%20in%20Elasticsearch" target=_blank rel=noopener class=share-btn-linkedin><i class="fab fa-linkedin-in"></i></a></li><li><a href="https://web.whatsapp.com/send?text=Phrase%20Search%20with%20Synonym%20Graph%20Token%20Filter%20in%20Elasticsearch%20https://www.jocas.lt/blog/post/synonym-graph-phrase-search/" target=_blank rel=noopener class=share-btn-whatsapp><i class="fab fa-whatsapp"></i></a></li></ul></div><div class="media author-card content-widget-hr"><div class=media-body><h5 class=card-title><a href=/blog/authors/dainius-jocas/></a></h5><ul class=network-icon aria-hidden=true></ul></div></div><div class="article-widget content-widget-hr"><h3>Related</h3><ul><li><a href=/blog/post/percolator-phrase-analyzers/>Elasticsearch Percolator and Text Analyzers</a></li><li><a href=/blog/post/es-percolator-phrase-highlight/>Phrase Highlighting with the Elasticsearch Percolator</a></li></ul></div></div></article><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin=anonymous></script><script>hljs.initHighlightingOnLoad();</script><script>const search_config={"indexURI":"/blog/index.json","minLength":1,"threshold":0.3};const i18n={"no_results":"No results found","placeholder":"Search...","results":"results found"};const content_type={'post':"Posts",'project':"Projects",'publication':"Publications",'talk':"Talks"};</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/blog/js/academic.min.d6bd04fdad2ad213aa8111c5a3b72fc5.js></script><div class=container><footer class=site-footer><p class=powered-by>Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.
<span class=float-right aria-hidden=true><a href=# class=back-to-top><span class=button_icon><i class="fas fa-chevron-up fa-2x"></i></span></a></span></p><p>Copyright &copy; 2019 <a href=https://www.jocas.lt>Dainius Jocas.</p></footer></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i>Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i>Download</a><div id=modal-error></div></div></div></div></div></body></html>